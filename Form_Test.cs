using Medivest_BarCodePrinter.Helper;
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;

namespace Medivest_BarCodePrinter
{
    public partial class Form_Test : Form
    {
        public Form_Test()
        {
            InitializeComponent();
            
        }

        void GetListOfPrinter()
        {
            try
            {
                var printerList = new List<string>();
                foreach (string printer in System.Drawing.Printing.PrinterSettings.InstalledPrinters)
                {
                    printerList.Add(printer);
                }

                cboPrinterNames.DataSource = printerList;
                if (printerList.Count == 0)
                {
                    return;
                }

                // 20200818T0917 
                // hard code the printer name 
                int locId = printerList.FindIndex(x => x.ToLower()
                                                      .Contains("ZDesigner ZD230-203dpi ZPL"));
                if (locId <= printerList.Count)
                {
                    cboPrinterNames.SelectedIndex = locId;
                }
            }
            catch (Exception excep)
            {
                MessageBox.Show($"{excep}", "Alert", MessageBoxButtons.OK, MessageBoxIcon.Exclamation);
            }
        }

        private void button1_Click(object sender, EventArgs e)
        {
            /*
             * ~DGR:mdlogo.GRF,11550,75,nL09J548mG01521248929lY02A0949252I4lW01H4A4525249294lV0A292909089284A8lT02492H4A4A5245212lT092H492525092948lT02492929090A484lV092492H4A4A52K0A8lP024924929291L0A25lP092A92492848K0515lQ04A1292485L05248lP0124C84925L0A892H0A8lP02H54M051248052mG05249201094lY028925404A4lY01454920125208lV014A825H0251024lV04A1592H090A02AlU0HA14248012A8091lJ0DO0A215292H0AH402A4lI012A8L0A54C8A48024920H48lI0289291H2H528A2514H0525412901lH045494A492492154AH010920292048lG0A924A52A924ADH28H04A480H4802lG01249510914951094H012HA80HA4154l029248IA42524HA9H0A9H102H10H14l024HA52495949524H0214A809A404AlG092914924852489I0942H4045H025lG04A4A24HA549H54H01259202AH815lG01512H95H1525H2I0492540492024A02kX012HA452HA25494H01254901248052808kY094954H895H24I0A94A401524129H05l024926H5295I024521H048A8084012l0954A94H8AJ092895015280H540H1lH0A94AH5J0254IA0494A024804A8lH04512K094A52H0A4AH092402H4lP0H521250H1H2014A0152AjW07FDV02R01249H5H02HA80252H0891S04R01K01O5H01K52P02A80158P02A8H0OA8I038954J0OAH054Q0A9254H80924A09280254AS04R02K02DB6DB6DB6I0DB6D5AEAN02DH016AP05BI0B6DB6DB6D4I0A76HAJ0B6DB6DB6DH02HAO0A9H54A501492H0A9H05H21S04R03K01O5H01J5ABH54M0158H0HAP0H5I0NABJ0IAB74I0DN5H09294M052524A2804AH5024A40894AS0BR048J02OAH01I56AD5ABM02A8H0ACP0HAI0ADM58H035HAD54I0LADH5H04A535J02B4949H2AH0A54802A40124294R0CR068J016DB6DB6DBI0B6DAB56B54L02DI056P0B4I0B5B6DB6DA8H02ABI54I0B6DB6D5B60152A94DIA90IAH5940128AH0A52H092848R07R05K02HADL5H01ABJ5AD6FL02BI05BP0ACI0OA8H0ADA4B5BI0DK5IA012A4A52J56492A85H054A50I140549524R098Q0A8J01B52LAI0A8MA94K0158H029O0154I0ADM5I0B5I0D5I02KAH540152A52A9H249249254014A5202HAH0H2H492R0A8P0168J02A8O016CJ02B56AK02DI02D8N01B4I0B4P0D5I0H5CK01BK024A52A4A9K5495H0252940495H0952948R0D4P015K015P015L016ADK02A8H02A8N02A8I0A8O0154I0364K02A8J02A9292A952492AH52H09295H0A520148A4H5Q0154P01A8J01A8P0ACL02D58J02BI0154N02DJ0ACO0158I01B4K0158J04954A9249524AH528025H48029480H251282R0B4P02B4J02BP01BM0156AJ01A8I0D8N0H5J0B4O02A8J054K01A8J02A4A4A9H52HA912AH094HA40152804A8A929Q0156P0H5K0158P0ACM05ACJ02A8H0156N056J0D4O01BK0A8K02A8J0A52954HA4AJ548H05295H0495H028524A48P015BP05ACJ02A8O015N0156J02BJ054N06AJ054O02A8J04L0168J054A52549294894AH05HA524154801454924AQ016AP06B4J0168O016CN0ABJ01A8I0B6N0ACJ0HAO02DR02A8J0LAJ5254A8H0A254802A54012A249214P01H58O0HA8J02A8P0BO06A8I02A8I0H5N0D4J0D8O02A8Q015K0925252A4A4IA9H0295254045280491524948P01568N01H54J015P01ACN02DAI02BJ02BM0154J0ACO0158Q02D8J0H54HA92A9H5494H0A54A9H0A94H054A4924A4P01HA8N016D8J02D8P0A8N02A8I01A8I035M0168J0A8O02A8Q015L0HA94A925292AH0254A94012HA810A52H525Q02B56N01H56J015P0154N0156I02A8I01ACL02A8J0B4O01B4Q02A8K01252AH54A54I094A4A802924H0A109H290AP0156AN03568J02A8O0168O0B4I02BJ0168L035K0HAO0154Q0168L01H52KAI0152954H0AH5H02ACA49H4A4P02D5AN056ACJ0168P0A8O057I01A8I0154L0568J0ACP0D4Q02A8N0IA4A9J052A54A8094940H42HA49292P0352AN0I56J02A8O0158O06AI02A8J0B4L0H5K0D4O015AQ015Q012K02KA802IAH0IAH152948P0152DN05454J01BP0168O02BI02BK0D6L05AK054P0ABQ02D8P08K01549292H0H524H04914A2H42AP056358M0B65AJ02A8O0154O0358H01A8J0H5L0HAK0D8P0H58P0168V0D4IAH5H0A4A80292HA54IA5P02A0A8M0D454J015Q0A8O016I02A8J05AL0D4K0ACP036DP02A8I02Q064A9495H0152A8024H851I248P05A16CL01542BJ0168O01B4O02ACH02BK0H5K015AK0HAP02HAP015J0H5O052HA52HA8052A9H092A5149H525P0540A8L02A85AJ02A8P0A8O0154H01A8J02BK0168K0D4P01H58O02A8I02AD4K02BI52IA4H0HA54H054954A50892P02A0AEL01B02AJ01BP0154O01B4H02BK02D8J02A8K0A8Q0AD4O01BJ0H52BEKA94A954A5401H548028A51252A549P06C06AL06A02DJ02HADL5H0168P0A8H02DK0154J02DL0B76DB6IA8I06AFO02A8I02HA82HA9I52A54A95H0524A8015124AH85H24P05602AL02A035J01575B6DB6DI0A8O0154H02A8J0154J0H5L0LADB68I01H54N0158I05257H54IA4A952A54H0JAH0A4A952H529528O0540358K0AD02AJ02B4MAH01B4P0B4H015L0D4J05A8K0AD56DJ5K0D54N02A8I04HA8HAH52J54A95H014A54H052949492848AP06A02A8K05402BJ0156D5BJ5I0A8P0D4H02B8K0B6J06AL0D5BH5B6AB8J05AFN0168I0H54HAH54JA52AH5H0529480129424949H529P0A80168J01B4015J02DHAD56DB6H0154P0HAH02C8K0HAJ0HAL0MADAK02B14M02A8I054HA954HA9294IA8H0JA805H42HA4A452H48O05C0154K0A802DJ01O5H0168P0B4H02BL0H5J0ACL0B6D6DJ58K0D68M01BJ052HA54IAM5H029I5H02H5A91212892AP0A4H0B4J02D80158I02A8924J8I0A8P0HAH02A8K05AI01B4L0A808124H2L05AEM02A8I0I52IA9H54IA94H02A9240152I4A9H524A5P0D8H0D4J02AH01A8I0168O0158P0A8H01BL02BI0154L0D6S02B3M015J0H52IAH52IA54A801J54H0892HA9548HA508O0ACH02EJ02BH015J02A8O0168P0DCH02A8K02D8H02A8L0A8T0AD8L02B8I0K52AI5294HAH02A4HA802I512H425H10A8O0A8H053J05AH0168I01A8O0154P0A4H02A8K02A8H02DM0B4T0H56L0148I052HA9J52JA8H0IA95H05492H52HA94IAP0B4H03DJ06AH01A8I02BQ0A8O0158H02DL0154H0H5M0ACT03H5L02E8I0H549I54IAH54H0149H54H0924948A494A9H48N015I0128I0HAI0B4I015P01B4P0ACH0158L0DAH0568L0HAT016AL0128I0H52IA929J5I0I54A8014954A52A42H429O0168H01A8I0ACH015J02A8P0A8O0168H02A8L0HAH05AM0D4U0AD8K02DJ054DH52I54HA8I0KAH012A925291592HA48N0158I0B4H0168I0ACI0168O0154O0154H02DM0HAH0HAM0A8U0H54K0158I0532A4KA95I02AJ5H04AH4A894A45492AO015I0154H01A8I0D4I02A8O0168P0A8H02BM06AH0D4M0B4U0368K02A8I054MAH5J0A94A48H0512A454H5292491O0168I0HAH02A8I0B4I015Q0A8O01B4H02A8L05B015AM0ACU0156K01BJ0O5A8I02IA954014D52HA5214A52A5O015J06CH02BJ0D4I02D8O01B4O02DI01BM02A8168M0D4U01HAK02A8J0NAK0LAH025249H1294A529148N01A8I02BH06CJ0A8I015Q0A8O02A8H02A8L02D02A8M0HAV0B5K015L09J54K03L5H05292IA9H5108A52O02BJ035H056J0ACI02A8O0154O02BI02A8L02A835N0B4V056K02B8V0CA92HA8H0894A494A4956A549O015J015H0A8J054I0168O0168O06DI02DM0158568M0A8V05AK015V0K54AH0154A9242524912894O02DJ02D80DAJ0B6I02BQ0A8O0H5I0158L016CH5N0ACV06BK02D8T02MAH02524JA8924A95H28N035J0154168J054I01A8O01B4O0B4I02A8M0HA5AN0D4V02AK015T01L528H052HA4929J5I495O015K0HA2A8J05AI02A8P0A8N01HAI02DN0JAN0HAV0H5K02A8S0KA54A8H09492A49492492HA52O05AK0B42A8J06AI015P0154N0154I02BN06HACN0B4O02L05BK01BS0BL535H02A549154A492492548O02AK0562DK054I02B8O0168N0568I02A8M056D4N0HAO05L02AK02A8Q0LAH54AH025254A9252IA49126O056K0J5K056I0148P0A8N06A8I01BN05HA8N0ACN0168K06BK0158O056BN5I0A952HA4A8A492IA9P02AK02AB6K02AI02E8O01B4M01H5J02A8M02AB4N0D4N02A8K0ADK02A8M057H54NA8014A4A52A9H524924854O06CK02D54K05BI0128P0A8M015BJ02A8M02B5O0A8N01B6K054K0168I01BH754LA9I54H0H2529292524HA49254AO056K015A8K02AI02DP0154M06HAJ02DN01H58N0B4O0HAJ01B6K02A8J0A94NA6IA8H05A95494949292HA9524O054K016B4K035I0158O0168L01AD4J0158M01ADO0ACO0DAK0HAK01A8I01T54H014548HA2HA54A924A95P05AL0ADL02BI02A8O0158L0AB58J02A8N0B5O0HAO0H58I0354K02BK0RA928H01292A495494AH492H494O0HAL0HA8K02DI01BQ0A8J016D56K0368N0HAO0D4O02ACI0AD8K0158J0PAJ5I04IA52HA25292KA48O054L0H5L02AI02HAD6DB6B5H01ADI5BD56D8K015O0ACO0HADBI76D8036BH02B5L02A8J0MAL54I0A949H52H54AH524912AP0B4L05AL02BI015B5JAD6I0BL5JAK02A8N054O0B6ADJ56801H5A2AD5L01A8J0S5I029525249292949524A91P0D4L02AL01A8H02D56IABH5H01H5B6DJ5AL02D8N058O0HAB5IAB5I0AD5DH56L02BK0R548H04JA9H54I52A4HA94A8O058L02CL02A8H0156AB6DIAH016JAD56D4L02A8N028O0ABI5B6D58H0H56AB58L015K0R52H0129124A92HAH4A52924A9P0ACL014L015I02IADJ5AH0156DI5BH5M02A8N028O0BI56JA8H02BH5HA4L02A8J02QAI02A54954A9292A92A49514P0D4L014L0168H016D6JAD5I0IADB6HAN0168N01P0D5B6HAB5A8I0D56ADM01B4J02PA8I0A54HA924A9H52549H52A2P0A8M08M09I01252J52AH01H5249Q029O01P02A49H54A5J02B568N09K01P5I01H52HAI54A2494A52492AjV0HA9U01OA8I052952549H2H52HA5492A94kU0ADL54J0A94HA92A9A92A49H2HAH48kU0NA8I0294A94HA4A54AK5252AkV0D56DI54J0A4A952AI52H52492952A54kU02KACJ029I52A54A4949524949494kV0J56DK0AH524A54A9H52A4IA54A528kU02JAK029529H52A952HA5294925294kV01B6AL0A54A5294952A494A52HA94A4kV014M0I529J5494925294A494A94lJ01294JA4AH52JAI52A525lK0HA52HA92A952IA9H5H2A52948lI054JAI5252A4925295492952lI02AK54A954AH54HA949H54A4AlH05A9524A4A952A94AH524HA492928l0154954HA9H54952HA95295252J54kY0AD2LAH52H54A52529I54HA492l054DH5254952IAH54IA5292I524A8kY02A94IAH54A94952A9494A4HA48HA9l02A529K54IA94952HA9H52AH524l012IA92A4IAK52A52HA952A954lG0JAH52A9H5494A4A54A5252A949lH0K54HA5252A52JA94HA9252A8lG02A4JAI54KA9495292H54A4lH012A952LAI5252JA949294lI0IA9I54929492IA4949K5lJ0K5292HAI5494IAI5294A8lI012JAL54IA9H54A4A528lJ015252IA92A92HAH524A9H54A4lK0H54AH54HA4HA954IA95292A8lK02KAM52A95252A4A9lL01I54954HA92H5252IA9H54lM04LA92H54IA9549H52lN03252A92KA954A4HA495lO0JAK52H52I529H54lO0I52HA92954LAH52lP014JAK549492H529lQ0A9J54A92NA4lQ0154AI54HAH52HA924lS0HA94A52IA4A49H5lT01M529J528lU02HA94A9I52IA2lV0HAJ54A95248lW012IA52954HAlY0J54D52A9mH092JA4mJ08A9zgP0
                        ^FX logo display
                        ^FO30,30
                        ^XGR:mdlogo.GRF
            ^FS
                        ^FX barcode display
                        ^BY5,2,210
                        ^FO30,210
                        ^BC
                        ^FDC15-00001^FS
                        ^FS
            ^FX Model display
                        ^CFB,30
                        ^FO30,30^FDModel: 277ML
                        ^FS
             */

            var zplCode = @"^XA
                            ~DGR:MDVLOGO.GRF,2926,38,N0I4iR0A92948iO050484A4iN028A9291iO0852492H05iL0252494H028iL01292I01H45iQ014908iQ08A42H4iO0A510489iI08J0A4941212iH012902A52404824iH024A5H4890128904iG04A4HA9240491412iG0252414A82A4I28i015152C280490484iH04C892A0124120208i012549H04A849191iI0A4H02A90A4240AiL0914H104852L02L04H0K50I5K01414K0502JAH05E802JAH0A8J054A02A12024V02DB6D02DAECI0140AK0A02DB6DH0HA8036DB6H05280154A90920A0928K03L0CH06JA0K58I080AK0A02IAB02D5602JA014AH54HAH42A854149L01L04H02AI505KAH01405J01402IA90341B02AH54H0A9525H2A849050H24L028J018H05K05I06AH018068I014028J048048H05I024A9549520A4128H528K05L0CH05K028I0D8H0C028I014028J03H03I05I0124A92A90254290H894K038J032H02K05J02801H028I02803K05L05I02HA94HA40948H40524L04CJ01AH05K05J02CH0C028I03H018J05L02I01H54HA502520A82892CK06AJ06AH05K05J014014014I05H028J05L05J024A95H0954128154A2K02AJ02AH05K03K0A014014I05H028J028K06K02A5H02528490AH294K0H5J0D4H02K05K0B014H0EI0AH03K03L03P0IA054054A49K0H5J04AH05K05K05H08H09I0AH028J02CK05O0HA941541H2924K0A28H01HAH05K028J05014H06H014H028J016K02I0D4I0HA95029054A492K0A3J085H05K05K02818H05I0AH028K0BK05I02BJAI504A0H29249K0414H0345H02ADH5058J05H0CH05H02CH03J5H05CJ05I0A8KA521H509H4954K0A18H0106H05B5B605K0281I028028H02ADB6H016J05I0KA95482A8152A5H2K0A0CH0582H0K5028J03H0CH028028H02BI5I0A8I02I02K52A049024A5495K0A06H0505H05K05K01814H01C05I028L058I07I0HA924HA81H505251248K0A0AH0A05H02K05K02814I0805I03M02EI01I0L5402HA08A8A925J01405H0602805K05K05014H0160AI028L012I06I0L5H0A541525H4HAK080281805H06K03K05808I0A0AI028M0BI03I054IA802HA8H294HA91J01403H0C02803K05K0501CI050CI028M058H05I0I548H0IA054AH2H4AJ0180142802804K05K05H04I0614I028M024H05O03H540252A92A4K0C0182802803K028J0A018I0294I03N018H02N014HA815294HA52J014H0C5H01H05K05K0AH0CI0528I028M028H05N0IA5029H4A4915J014H065H03805K058I014014I02BJ028J04H014H05M0KA04AH5124C8J028H0HAI0802K05J02A014I01A8I028J08H02CH05K05KA80A52JA24J01I056H02805K028I054H08I015J028I016H03I02I056LA0252A124954J038H028H01405K05I0158014I016J028J0AH048H07I02MA01491H525H2K08H034H01805K05H016DH018J0AJ03K0580BI01I02LA80D2IA4A954J03I014I0C02B5AD05DBD54I0CJ0AJ02DI506AH5I06I01K54024A4A5294H8J028H018H01406D6B402AC5A8H01K04J02ADB6015HAI03I02KA805295294AH5K028L01402IAB0H57A8J0CJ04J02BH5BH0D58I05I01K5012IA94A5248hM02CO0JA80294A4A52952hY0JAH095292529495hY0H56H02IAH54A52A4hY05AI0951I5294A52iI0252A492A52928iH01H54IA954A548iG01K524A4A94A4i0IA9252JA9529iG0K54AH52H54A5iG02A92JA4A92H54iG012H52I52A4HA9iI0KA49J5248iH0HA9K52A895iI02A52954A926HAiI01J5254HA95iK0H54KA952iK02HA95492528iK012H52J548iL0M54AiM0152HA4928iN02A9I54iP0H52A8iS0AmH0
                            ^FX logo display
                            ^FO240,30
                            ^XGR:MDVLOGO.GRF
                            ^FS
                            ^FX barcode display
                            ^BY5,2,90
                            ^FO66,120
                            ^BC
                            ^FDC15-00001^FS
                            ^FS
                            ^FX Model display
                            ^CFA,30
                            ^FO30,270^FDModel: 277ML
                            ^FS
                            ^FX Item name display
                            ^CFA,30
                            ^FO30,300^FDAntirust - WD spray (WD40) - 277ml.
                            ^FS
                            ^XZ";

            // text send data to print see the label result 
            RawPrinterHelper.SendStringToPrinter(cboPrinterNames.Text, zplCode);
        }

        private void Form1_Load(object sender, EventArgs e)
        {
            GetListOfPrinter();
        }
    }
}
